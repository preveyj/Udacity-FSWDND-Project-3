<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
<link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://apis.google.com/js/client:platform.js?onload=start" async defer></script>
<script type="text/javascript">

function signInCallback(authResult) {
	if (authResult['code']) {
		//Hide button
		$("#sigInButton").attr('style', 'display:none;');
		//Send one-time code
		$.ajax({
			type: 'POST',
			url: '/gconnect?state={{STATE}}',
			processData: false,
			contentType: 'application/octet-stream; charset=utf-8',
			data: authResult['code'],
			success: function(result) {
				if (result) {
					console.log('Logged in');
					location.reload();
				} else if (authResult['error']) {
					console.log('There was an error: ' + authResult['error']);
				} else {
					alert('Failed to make a server-side call.  Check your configuration and console.');
				}
			}
		})
	}
}

function doLogout() {
	$.ajax({
		url: '/gdisconnect',
		processData: false,
		success: function(result) {
			if (result) {
				console.log('Logged out');
				location.reload();
			}
		},
		error: function(result) {
			alert('Error logging out.  Please navigate to the index and try again.');
		}
	})
}
</script>